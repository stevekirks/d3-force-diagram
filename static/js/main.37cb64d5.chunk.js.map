{"version":3,"sources":["utils/utils.ts","utils/search-matching.ts","utils/superformula.ts","diagram.ts","constants.ts","diagram-styles.ts","utils/url-query-param-utils.ts","app.tsx","reportWebVitals.ts","index.tsx"],"names":["nodeRadiusSizes","defaultNodeSuperformulaType","d","shapeType","nodes","getRadius","resultRadius","size","biggestSize","iNode","getHighlightedRadius","Math","sqrt","convexHulls","hulls","n","group","i","strToLowerOrEmpty","hasOwnProperty","offsetAndRadius","push","x","y","hullset","Object","keys","newHull","d3","path","drawCluster","curve","tension","transitionLinear","duration","ease","isNodeNotString","isLinkNotNode","undefined","source","getNodeId","nodeId","name","getLinkGradientId","sourceChild","getLinkSourceName","targetChild","target","getLinkTargetName","replace","getNodeNameOrGroup","node","getNodeNameAndGroup","getLinkSourceNameOrGroup","link","getLinkTargetNameOrGroup","getNodeOrLinkTitle","nodeOrLink","title","doGroupsMatch","node1","node2","findIndex","arr","callback","length","nodeTextShiftRight","multiplier","darkenIfInvertedBackground","color","isInverted","darker","toString","strEquals","val1","val2","toLowerCase","val","GetMatchedNodes","highlightedNodes","nodeElements","filter","nodeNameOrGroup","utils","DoesLinkMatch","l","onlyLinksWithHighlightedSourceAndTarget","linkSourceNameOrGroup","linkTargetNameOrGroup","highlightedSourceFound","highlightedTargetFound","GetMatchedLinks","linkElements","GetMatchedLinkGradients","GetMatchedHulls","hullElements","h","highlightedNode","highlightedNodesChangedCallback","sLine","Superformula","sType","sSize","sSegments","this","getPath","bind","f","sizeMultiplier","typeKey","SuperformulaTypes","_superformulaPath","params","diameter","t","dt","PI","r","ts","points","m","pow","abs","cos","a","n2","sin","b","n3","n1","SQRT1_2","asterisk","bean","butterfly","circle","clover","cloverFour","cross","diamond","drop","ellipse","gear","heart","heptagon","octagon","hexagon","malteseCross","pentagon","rectangle","roundedStar","square","star","triangle","colorScale","schemeDark2","slice","highlightColor","everythingElseColor","linkGradientColorEnd","linkGradientColorEndInverted","durationLong","defaultSupaDupaPath","type","segments","nodeStateDefault","className","nodeTextShiftMultiplier","shapeSuperformula","nodeStateHighlight","nodeStateSearch","nodeStateHighlightNeighbour","nodeStateUnhighlighted","DiagramStyles","showOnlyHighlighted","invertedBackground","showAllLabels","mouseOverLock","mouseOutLock","nodeEles","clearStates","classed","nodeShape","selectAll","nodeText","transition","attr","constants","style","opacity","text","bigSuperdupaPath","bd","nodeState","getNodeStateProperties","mouseOverTransition","tween","nodeData","data","shiftFrom","shiftTo","Number","mouseOutTransition","linkEles","linkGradientEles","stopOne","stopTwo","hullEles","load","highlightedNodesChangedCallbackArg","initialHighlightedNodeNames","initiallyShowOnlyHighlighted","diagramWidth","floor","window","getComputedStyle","document","getElementById","width","diagramHeight","height","svg","append","on","onBackgroundDiagramClick","svgDefs","zoom","scaleExtent","translateExtent","zoomed","call","simulation","force","id","distance","slDatum","combinedRadiuses","strength","s","radius","distanceMin","html","process","then","uResponse","response","links","select","remove","updateSimulation","highlightedNodeName","nodeIdx","hn","cn","ungroupNodes","searchForNodes","searchText","hasSearchedForNodes","matchedNodes","indexOf","searchUtils","diagramStyles","show","highlightNodes","biggestNodePerGroup","linkGradients","hasForceSimulation","evt","ele","transform","k","tickHulls","tickLinks","exit","linkGradientsEnter","enter","applyLinkGradientDefault","merge","linkEnterElements","applyLinkMouseOver","applyLinkMouseOut","PopulateInfoBox","applyLinkDefault","drager","dragSimulationRestarted","alphaTarget","restart","fx","fy","dragged","dragended","nodeEnterElements","applyNodeMouseOver","applyNodeMouseOut","onNodeClick","onNodeDblclick","applyNodeDefault","hullEnterElements","applyHullDefault","groupedDictionaryOfNodes","groupedDic","nodeWithMostNumberOfInternalLinks","nodeWithLinkCount","numberOfInternalLinks","nodeName","kLink","isInternalLink","lNode","alpha","biggestNode","x1","y1","alphaMultiplier","xr","yr","xd","yd","bxr","byr","bxd","byd","isNaN","alphaMin","alphaDecay","stop","active","highlightedNodeIdx","splice","stopPropagation","newNodeGroup","internalLinks","kNode","mLink","m1","m1Link","regroupNodes","k1","random","k2","Array","prototype","apply","k3Link","childMNode","lLink","map","matchedNodesData","matchedLinks","matchedLinkGradients","unmatchedLinks","unmatchedLinkGradients","neighbourNodes","highlightedLinks","nodeNeighbourNamesOrGroups","highlightedNodeNamesOrGroups","highlightedLink","some","nog","nameOrGroup","highlightedAndNeighbourNodesData","concat","unmatchedNodes","matchedHulls","unmatchedHulls","highlightedHulls","applyNodeSearch","applyNodeHighlight","applyNodeHighlightedNeighbour","applyNodeUnhighlighted","applyLinkHighlight","applyLinkUnhighlighted","applyLinkGradientHighlight","applyLinkGradientUnhighlighted","applyHullHighlight","applyHullUnhighlighted","divServiceDetails","notes","tableElement","timestamp","details","tableData","entries","row","getUrlParameter","sParam","keysString","sURLVariables","split","sParameterName","getKeysFromString","decodeURIComponent","location","search","substring","setUrlParameter","sValue","queryFilters","paramPairs","paramPair","parameterUpdated","join","updateKeysInString","history","pushState","urlParamLabelShowOnlyHighlighted","urlParamLabelHighlightedNodes","App","props","highlightedNodeNames","paramValueStr","getUrlParameterAsArray","state","inputHighlightText","invertBackground","handleInputHighlightText","handleShowAllLabels","handleShowOnlyHighlighted","handleHighlightedNodesChanged","updateShowAllLabels","updateInputHighlightText","handleInvertBackground","handleHasForceSimulation","handleSearchForNodesClick","diagram","onChange","value","disabled","onClick","checked","htmlFor","setState","txt","sValueArray","setUrlParameterAsArray","event","newVal","currentTarget","preventDefault","invert","React","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode"],"mappings":"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","file":"static/js/main.37cb64d5.chunk.js","sourcesContent":["import * as d3 from 'd3';\nimport { Link, Node, Hull } from '../data-interfaces';\n\nexport const nodeRadiusSizes = { default: 3, node: 3, group: 7 };\nexport const hullOffset = 15;\nexport const nodeStateNormal = 'node-state-normal';\nexport const nodeStateHovered = 'node-state-hover';\n\nexport function defaultNodeSuperformulaType(d: Node): string {\n  let shapeType = 'circle';\n  if (d.nodes) {\n    shapeType = 'circle'; // \"octagon\";\n  }\n  return shapeType;\n}\n\nexport function defaultNodeSuperformulaSize(d: Node): number {\n  return 2 * getRadius(d);\n}\n\n// Transform the list of nodes into groups\nexport function getBiggestNodesPerGroup(nodes: Node[], links: Link[]) {\n  const groupedDictionaryOfNodes: { [key: string]: Node } = {};\n  for (const node of nodes) {\n    if (node.group) {\n      const group = strToLowerOrEmpty(node.group);\n      groupedDictionaryOfNodes[group] = groupedDictionaryOfNodes[group] || node;\n      groupedDictionaryOfNodes[group] =\n        !groupedDictionaryOfNodes[group] || (groupedDictionaryOfNodes[group].size || nodeRadiusSizes.default) < (node.size || nodeRadiusSizes.default)\n          ? node\n          : groupedDictionaryOfNodes[group];\n      if (!groupedDictionaryOfNodes[group].size) {\n        groupedDictionaryOfNodes[group].size = getRadius(groupedDictionaryOfNodes[group]);\n      }\n    }\n  }\n\n  for (const groupedDicPropName of Object.keys(groupedDictionaryOfNodes)) {\n    let groupedDic = groupedDictionaryOfNodes[groupedDicPropName];\n    if (groupedDic.size === nodeRadiusSizes.default) {\n      let nodeWithMostNumberOfInternalLinks = null;\n      // If the biggest node is the default size, ensure the biggest node is the one with the most \"internal\" links\n      for (const jNode of groupedDic.nodes!) {\n        const nodeWithLinkCount = { node: jNode, numberOfInternalLinks: 0 };\n        const nodeName = nodeWithLinkCount.node.name;\n        for (const kLink of links) {\n          let isInternalLink = false;\n          if (strEquals(kLink.source, nodeName) || strEquals(kLink.sourceChild, nodeName)) {\n            for (const lNode of groupedDic.nodes!) {\n              if (strEquals(kLink.target, lNode.name) || strEquals(kLink.targetChild, lNode.name)) {\n                isInternalLink = true;\n                break;\n              }\n            }\n          } else if (strEquals(kLink.target, nodeName) || strEquals(kLink.targetChild, nodeName)) {\n            for (const lNode of groupedDic.nodes!) {\n              if (strEquals(kLink.source, lNode.name) || strEquals(kLink.sourceChild, lNode.name)) {\n                isInternalLink = true;\n                break;\n              }\n            }\n          }\n          if (isInternalLink) {\n            nodeWithLinkCount.numberOfInternalLinks++;\n          }\n        }\n        if (!nodeWithMostNumberOfInternalLinks || nodeWithLinkCount.numberOfInternalLinks > nodeWithMostNumberOfInternalLinks.numberOfInternalLinks) {\n          nodeWithMostNumberOfInternalLinks = nodeWithLinkCount;\n        }\n      }\n      groupedDic = nodeWithMostNumberOfInternalLinks!.node;\n    }\n  }\n  return groupedDictionaryOfNodes;\n}\n\nexport function getRadius(d: Node): number {\n  let resultRadius = nodeRadiusSizes.node;\n  if (d.size) {\n    resultRadius = d.size;\n  } else if (d.nodes) {\n    resultRadius = nodeRadiusSizes.group;\n    let biggestSize = d.nodes[0].size || nodeRadiusSizes.default;\n    for (const iNode of d.nodes) {\n      biggestSize = (iNode.size || nodeRadiusSizes.default) > biggestSize ? iNode.size || nodeRadiusSizes.default : biggestSize;\n    }\n    resultRadius = biggestSize > resultRadius ? biggestSize : resultRadius;\n  }\n  return resultRadius;\n}\n\nexport function getHighlightedRadius(d: Node): number {\n  const resultRadius = getRadius(d) + Math.sqrt(getRadius(d));\n  return resultRadius;\n}\n\n// For Hulls\nexport function convexHulls(nodes: Node[]): Hull[] {\n  const hulls: { [key: string]: [number, number][] } = {};\n\n  // create point sets\n  for (const n of nodes) {\n    if (n.nodes || !n.group) {\n      continue;\n    }\n    const i: string = strToLowerOrEmpty(n.group);\n    if (!hulls.hasOwnProperty(i)) {\n      hulls[i] = [];\n    }\n    const offsetAndRadius = hullOffset + getRadius(n) + Math.sqrt(getRadius(n));\n    hulls[i].push([(n.x || 0) - offsetAndRadius, (n.y || 0) - offsetAndRadius]);\n    hulls[i].push([(n.x || 0) - offsetAndRadius, (n.y || 0) + offsetAndRadius]);\n    hulls[i].push([(n.x || 0) + offsetAndRadius, (n.y || 0) - offsetAndRadius]);\n    hulls[i].push([(n.x || 0) + offsetAndRadius, (n.y || 0) + offsetAndRadius]);\n  }\n\n  // create convex hulls\n  const hullset: Hull[] = [];\n  for (const i of Object.keys(hulls)) {\n    const newHull = d3.polygonHull(hulls[i]);\n    if (newHull) {\n      hullset.push({ group: i, path: newHull });\n    }\n  }\n\n  return hullset;\n}\n\nexport function drawCluster(d: { path: [number, number][] }): string | null {\n  const curve = d3.line().curve(d3.curveCardinalClosed.tension(0.85));\n  const clusterPath = curve(d.path);\n  return clusterPath; // 0.8\n}\n\nexport function getGroup(n: Node): string | null {\n  return n.group || null;\n}\n// End For Hulls\n\n// Reusable transition\nexport function transitionLinear(duration: number): d3.Transition<d3.BaseType, any, any, any> {\n  return d3.transition().duration(duration).ease(d3.easeLinear) as any;\n}\n\nexport function isNodeNotString(x: Node | string): x is Node {\n  return typeof x !== 'string';\n}\n\nexport function isLinkNotNode(x: Node | Link): x is Link {\n  return (x as Link).source !== undefined;\n}\n\nexport function getNodeId(d: Node | string): string {\n  let nodeId: string = '';\n  if (isNodeNotString(d)) {\n    if (d.name && d.group) {\n      nodeId = d.group + '-' + d.name;\n    } else if (d.name) {\n      nodeId = d.name;\n    } else if (d.group) {\n      nodeId = d.group;\n    }\n  } else {\n    nodeId = d;\n  }\n  return nodeId;\n}\n\nfunction getLinkSourceName(d: Link): string {\n  if (d.sourceChild) {\n    if (isNodeNotString(d.sourceChild)) {\n      return d.sourceChild.name!;\n    } else {\n      return d.sourceChild;\n    }\n  } else {\n    if (isNodeNotString(d.source)) {\n      return d.source.name!;\n    } else {\n      return d.source;\n    }\n  }\n}\n\nfunction getLinkTargetName(d: Link): string {\n  if (d.targetChild) {\n    if (isNodeNotString(d.targetChild)) {\n      return d.targetChild.name!;\n    } else {\n      return d.targetChild;\n    }\n  } else {\n    if (isNodeNotString(d.target)) {\n      return d.target.name!;\n    } else {\n      return d.target;\n    }\n  }\n}\n\nexport function getLinkGradientId(d: Link) {\n  const gradientId: string = 'linkGrad-' + getLinkSourceName(d) + getLinkTargetName(d);\n  return gradientId\n    .replace(/ /g, '_')\n    .replace(/\\(|\\)/g, '__')\n    .replace(/[^A-Za-z\\w\\-:.]/g, '___');\n}\n\n// The Node Name or Group is used to identify the node\nexport function getNodeNameOrGroup(node: Node): string {\n  return node.name || node.group || '';\n}\n\nexport function getNodeNameAndGroup(node: Node): string {\n  return (node.group || '') + '-' + (node.name || '');\n}\n\nexport function getLinkSourceNameOrGroup(link: Link): string {\n  return typeof link.source === 'string' ? link.source : getNodeNameOrGroup(link.source);\n}\n\nexport function getLinkTargetNameOrGroup(link: Link): string {\n  return typeof link.target === 'string' ? link.target : getNodeNameOrGroup(link.target);\n}\n\n// The title can be used to identify the node or link\nexport function getNodeOrLinkTitle(nodeOrLink: Node | Link): string {\n  let title = '';\n  if (isLinkNotNode(nodeOrLink)) {\n    const sourceName = getLinkSourceNameOrGroup(nodeOrLink);\n    const targetName = getLinkTargetNameOrGroup(nodeOrLink);\n    title = 'Link: ' + sourceName + ' - ' + targetName;\n  } else {\n    title = getNodeNameOrGroup(nodeOrLink);\n  }\n  return title;\n}\n\nexport function doGroupsMatch(node1: Node, node2: Node): boolean {\n  return node1 && node2 && node1.group != null && node2.group != null && strToLowerOrEmpty(node1.group) === strToLowerOrEmpty(node2.group);\n}\n\nexport function findIndex(arr: any[], callback: (arg: any) => boolean): number {\n  for (let i = 0; i < arr.length; i++) {\n    if (callback(arr[i]) === true) {\n      return i;\n    }\n  }\n  return -1;\n}\n\nexport function nodeTextShiftRight(d: Node, multiplier?: number) {\n  const shiftRight = (getRadius(d) + 1) * (multiplier || 1.5);\n  return 'translate(' + shiftRight + ',0)';\n}\n\nexport function nodeTextOpacity(d: Node, showAllLabels: boolean): number {\n  let opacity = 0;\n  if (getRadius(d) >= 10 || showAllLabels) {\n    opacity = 1;\n  }\n  return opacity;\n}\n\nexport function darkenIfInvertedBackground(color: string, isInverted: boolean): string {\n  return isInverted ? d3.hsl(color).darker(2).toString() : color;\n}\n\nexport function setSimulationAlpha(simulation: d3.Simulation<Node, Link>) {\n  simulation.alpha(1).alphaMin(0.01).alphaDecay(0.02).alphaTarget(0);\n}\n\n/**\n * Safe, flexible string equals, case insensitive\n */\nexport function strEquals(val1: any | undefined, val2: any | undefined) {\n  return val1 != null && val2 != null && typeof val1 === 'string' && typeof val2 === 'string' && val1.toLowerCase() === val2.toLowerCase();\n}\n\nexport function strToLowerOrEmpty(val: string | undefined | null): string {\n  return val && val != null ? val.toLowerCase() : '';\n}\n","import * as d3 from 'd3';\nimport { Link, Node, Hull } from '../data-interfaces';\nimport * as utils from './utils';\n\n// Search for nodes using given text (this is not an exact match)\nexport function SearchNodes(\n  searchText: string,\n  nodeElements: d3.Selection<SVGGElement, Node, d3.BaseType, any>\n): d3.Selection<SVGGElement, Node, d3.BaseType, any> {\n  const matchedNodes = nodeElements.filter((d: Node) => {\n    const title = utils.getNodeOrLinkTitle(d);\n    if (title.length > 0) {\n      return title.toLowerCase().indexOf(searchText.toLowerCase()) !== -1;\n    }\n    return false;\n  });\n  return matchedNodes;\n}\n\n// Get the nodes matching those highlighted\nexport function GetMatchedNodes(\n  highlightedNodes: Node[],\n  nodeElements: d3.Selection<SVGGElement, Node, d3.BaseType, any>\n): d3.Selection<SVGGElement, Node, d3.BaseType, any> {\n  const unmatchedNodes = nodeElements.filter((d: Node) => {\n    const nodeNameOrGroup = utils.getNodeNameOrGroup(d);\n    if (nodeNameOrGroup.length > 0) {\n      for (const highlightedNode of highlightedNodes) {\n        const highlightedNodeNameOrGroup = utils.getNodeNameOrGroup(highlightedNode);\n        if (utils.strEquals(nodeNameOrGroup, highlightedNodeNameOrGroup)) {\n          return true;\n        }\n      }\n    }\n    return false;\n  });\n  return unmatchedNodes;\n}\n\n// Get the nodes not matching those highlighted\nexport function GetUnmatchedNodes(\n  highlightedNodes: Node[],\n  nodeElements: d3.Selection<SVGGElement, Node, d3.BaseType, any>\n): d3.Selection<SVGGElement, Node, d3.BaseType, any> {\n  return nodeElements.filter((a) => GetMatchedNodes(highlightedNodes, nodeElements).data().indexOf(a) === -1);\n}\n\nfunction DoesLinkMatch(highlightedNodes: Node[], l: Link, onlyLinksWithHighlightedSourceAndTarget: boolean): boolean {\n  const linkSourceNameOrGroup = utils.getLinkSourceNameOrGroup(l);\n  const linkTargetNameOrGroup = utils.getLinkTargetNameOrGroup(l);\n  let highlightedSourceFound = false;\n  let highlightedTargetFound = false;\n  // Either the source of the target must be a highlighted node\n  for (const highlightedNode of highlightedNodes) {\n    const nodeNameOrGroup = utils.getNodeNameOrGroup(highlightedNode);\n    if (onlyLinksWithHighlightedSourceAndTarget === true) {\n      if (utils.strEquals(nodeNameOrGroup, linkSourceNameOrGroup)) {\n        highlightedSourceFound = true;\n      }\n      if (utils.strEquals(nodeNameOrGroup, linkTargetNameOrGroup)) {\n        highlightedTargetFound = true;\n      }\n    } else if (utils.strEquals(nodeNameOrGroup, linkSourceNameOrGroup) || utils.strEquals(nodeNameOrGroup, linkTargetNameOrGroup)) {\n      return true;\n    }\n  }\n  return highlightedSourceFound && highlightedTargetFound;\n}\n\n// Get the links to the highlighted nodes\nexport function GetMatchedLinks(\n  highlightedNodes: Node[],\n  linkElements: d3.Selection<SVGLineElement, Link, d3.BaseType, any>,\n  onlyLinksWithHighlightedSourceAndTarget: boolean\n): d3.Selection<SVGLineElement, Link, d3.BaseType, any> {\n  const matchedLinks = linkElements.filter((l: Link) => {\n    return DoesLinkMatch(highlightedNodes, l, onlyLinksWithHighlightedSourceAndTarget);\n  });\n  return matchedLinks;\n}\n\nexport function GetMatchedLinkGradients(\n  highlightedNodes: Node[],\n  linkElements: d3.Selection<SVGLinearGradientElement, Link, d3.BaseType, any>,\n  onlyLinksWithHighlightedSourceAndTarget: boolean\n): d3.Selection<SVGLinearGradientElement, Link, d3.BaseType, any> {\n  const matchedLinks = linkElements.filter((l: Link) => {\n    return DoesLinkMatch(highlightedNodes, l, onlyLinksWithHighlightedSourceAndTarget);\n  });\n  return matchedLinks;\n}\n\n// Get the links with no direct connection to the highlighted nodes\nexport function GetUnmatchedLinks(\n  highlightedNodes: Node[],\n  linkElements: d3.Selection<SVGLineElement, Link, d3.BaseType, any>,\n  onlyLinksWithHighlightedSourceAndTarget: boolean\n): d3.Selection<SVGLineElement, Link, d3.BaseType, any> {\n  return linkElements.filter(\n    (a) => GetMatchedLinks(highlightedNodes, linkElements, onlyLinksWithHighlightedSourceAndTarget).data().indexOf(a) === -1\n  );\n}\n\nexport function GetUnmatchedLinkGradients(\n  highlightedNodes: Node[],\n  linkElements: d3.Selection<SVGLinearGradientElement, Link, d3.BaseType, any>,\n  onlyLinksWithHighlightedSourceAndTarget: boolean\n): d3.Selection<SVGLinearGradientElement, Link, d3.BaseType, any> {\n  return linkElements.filter(\n    (a) => GetMatchedLinkGradients(highlightedNodes, linkElements, onlyLinksWithHighlightedSourceAndTarget).data().indexOf(a) === -1\n  );\n}\n\n// Get the hulls with highlighted nodes inside\nexport function GetMatchedHulls(\n  highlightedNodes: Node[],\n  hullElements: d3.Selection<SVGPathElement, Hull, d3.BaseType, any>\n): d3.Selection<SVGPathElement, Hull, d3.BaseType, any> {\n  const matchedHulls = hullElements.filter((h: Hull) => {\n    if (h.group.length > 0) {\n      for (const highlightedNode of highlightedNodes) {\n        if (utils.strEquals(h.group, highlightedNode.group)) {\n          return true;\n        }\n      }\n    }\n    return false;\n  });\n  return matchedHulls;\n}\n\n// Get the hulls with highlighted nodes inside\nexport function GetUnmatchedHulls(\n  highlightedHulls: Hull[],\n  hullElements: d3.Selection<SVGPathElement, Hull, d3.BaseType, any>\n): d3.Selection<SVGPathElement, Hull, d3.BaseType, any> {\n  return hullElements.filter((a) => GetMatchedHulls(highlightedHulls, hullElements).data().indexOf(a) === -1);\n}\n\nexport function GetNeighbourNodes(\n  highlightedNodes: Node[],\n  highlightedLinks: Link[],\n  nodeElements: d3.Selection<SVGGElement, Node, d3.BaseType, any>\n): d3.Selection<SVGGElement, Node, d3.BaseType, any> {\n  // get list of nodes that are neighbours to the highlighted nodes\n  const nodeNeighbourNamesOrGroups: string[] = [];\n  const highlightedNodeNamesOrGroups: string[] = highlightedNodes.map((n) => utils.getNodeNameOrGroup(n));\n  for (const highlightedLink of highlightedLinks) {\n    const linkSourceNameOrGroup = utils.getLinkSourceNameOrGroup(highlightedLink);\n    const linkTargetNameOrGroup = utils.getLinkTargetNameOrGroup(highlightedLink);\n    if (\n      highlightedNodeNamesOrGroups.some((nog) => utils.strEquals(nog, linkSourceNameOrGroup)) &&\n      !highlightedNodeNamesOrGroups.some((nog) => utils.strEquals(nog, linkTargetNameOrGroup))\n    ) {\n      // the target node is a neighbour\n      nodeNeighbourNamesOrGroups.push(linkTargetNameOrGroup);\n    } else if (\n      !highlightedNodeNamesOrGroups.some((nog) => utils.strEquals(nog, linkSourceNameOrGroup)) &&\n      highlightedNodeNamesOrGroups.some((nog) => utils.strEquals(nog, linkTargetNameOrGroup))\n    ) {\n      // the source node is a neighbour\n      nodeNeighbourNamesOrGroups.push(linkSourceNameOrGroup);\n    }\n  }\n  // now that we have a list of nodes that are neighbours, filter by them\n  const neighbourNodeElements = nodeElements.filter((n: Node) => {\n    const nameOrGroup = utils.getNodeNameOrGroup(n);\n    return nodeNeighbourNamesOrGroups.indexOf(nameOrGroup) > -1;\n  });\n  return neighbourNodeElements;\n}\n","// Modified from source https://github.com/d3/d3-plugins/blob/master/superformula/superformula.js\nimport * as d3 from 'd3';\nimport { Node } from '../data-interfaces';\n\nconst sLine = d3.line();\n\nclass Superformula {\n  private sType: (d: Node) => string;\n  private sSize: (d: Node) => number;\n  private sSegments: number;\n\n  constructor() {\n    // defaults\n    this.sType = (d) => 'circle';\n    this.sSize = (d) => 1;\n    this.sSegments = 360;\n\n    this.getPath = this.getPath.bind(this);\n  }\n\n  public type(f: (d: Node) => string) {\n    this.sType = f;\n    return this;\n  }\n  public size(f: (d: Node) => number) {\n    this.sSize = f;\n    return this;\n  }\n  public segments(d: number) {\n    this.sSegments = d;\n    return this;\n  }\n\n  public getPath(d: Node, sizeMultiplier?: number): string {\n    let sType: SuperformulaTypeObject;\n    const typeKey = this.sType(d);\n    sType = SuperformulaTypes[typeKey];\n    return this._superformulaPath(sType, this.sSegments, this.sSize(d) * (sizeMultiplier || 1));\n  }\n\n  public allTypes(): string[] {\n    return Object.keys(SuperformulaTypes);\n  }\n\n  private _superformulaPath(params: SuperformulaTypeObject, n: number, diameter: number): string {\n    let i: number = -1;\n    const dt: number = (2 * Math.PI) / n;\n    let t: number;\n    let r: number = 0;\n    let x: number;\n    let y: number;\n    const ts: number[] = [];\n    const points: [number, number][] = [];\n\n    while (++i < n) {\n      t = (params.m * (i * dt - Math.PI)) / 4;\n      t = Math.pow(\n        Math.abs(Math.pow(Math.abs(Math.cos(t) / params.a), params.n2) + Math.pow(Math.abs(Math.sin(t) / params.b), params.n3)),\n        -1 / params.n1\n      );\n      if (t > r) {\n        r = t;\n      }\n      ts.push(t);\n    }\n\n    r = (diameter * Math.SQRT1_2) / r;\n    i = -1;\n    while (++i < n) {\n      x = (t = ts[i] * r) * Math.cos(i * dt);\n      y = t * Math.sin(i * dt);\n      points.push([Math.abs(x) < 1e-6 ? 0 : x, Math.abs(y) < 1e-6 ? 0 : y]);\n    }\n\n    return sLine(points) + 'Z';\n  }\n}\n\ninterface SuperformulaTypeObject {\n  m: number;\n  n1: number;\n  n2: number;\n  n3: number;\n  a: number;\n  b: number;\n}\n\ninterface SuperformulaTypeContainer {\n  asterisk: SuperformulaTypeObject;\n  bean: SuperformulaTypeObject;\n  butterfly: SuperformulaTypeObject;\n  circle: SuperformulaTypeObject;\n  clover: SuperformulaTypeObject;\n  cloverFour: SuperformulaTypeObject;\n  cross: SuperformulaTypeObject;\n  diamond: SuperformulaTypeObject;\n  drop: SuperformulaTypeObject;\n  ellipse: SuperformulaTypeObject;\n  gear: SuperformulaTypeObject;\n  heart: SuperformulaTypeObject;\n  heptagon: SuperformulaTypeObject;\n  octagon: SuperformulaTypeObject;\n  hexagon: SuperformulaTypeObject;\n  malteseCross: SuperformulaTypeObject;\n  pentagon: SuperformulaTypeObject;\n  rectangle: SuperformulaTypeObject;\n  roundedStar: SuperformulaTypeObject;\n  square: SuperformulaTypeObject;\n  star: SuperformulaTypeObject;\n  triangle: SuperformulaTypeObject;\n  [key: string]: SuperformulaTypeObject;\n}\n\nconst SuperformulaTypes: SuperformulaTypeContainer = {\n  asterisk: { m: 12, n1: 0.3, n2: 0, n3: 10, a: 1, b: 1 },\n  bean: { m: 2, n1: 1, n2: 4, n3: 8, a: 1, b: 1 },\n  butterfly: { m: 3, n1: 1, n2: 6, n3: 2, a: 0.6, b: 1 },\n  circle: { m: 4, n1: 2, n2: 2, n3: 2, a: 1, b: 1 },\n  clover: { m: 6, n1: 0.3, n2: 0, n3: 10, a: 1, b: 1 },\n  cloverFour: { m: 8, n1: 10, n2: -1, n3: -8, a: 1, b: 1 },\n  cross: { m: 8, n1: 1.3, n2: 0.01, n3: 8, a: 1, b: 1 },\n  diamond: { m: 4, n1: 1, n2: 1, n3: 1, a: 1, b: 1 },\n  drop: { m: 1, n1: 0.5, n2: 0.5, n3: 0.5, a: 1, b: 1 },\n  ellipse: { m: 4, n1: 2, n2: 2, n3: 2, a: 9, b: 6 },\n  gear: { m: 19, n1: 100, n2: 50, n3: 50, a: 1, b: 1 },\n  heart: { m: 1, n1: 0.8, n2: 1, n3: -8, a: 1, b: 0.18 },\n  heptagon: { m: 7, n1: 1000, n2: 400, n3: 400, a: 1, b: 1 },\n  octagon: { m: 8, n1: 1000, n2: 300, n3: 300, a: 1, b: 1 },\n  hexagon: { m: 6, n1: 1000, n2: 400, n3: 400, a: 1, b: 1 },\n  malteseCross: { m: 8, n1: 0.9, n2: 0.1, n3: 100, a: 1, b: 1 },\n  pentagon: { m: 5, n1: 1000, n2: 600, n3: 600, a: 1, b: 1 },\n  rectangle: { m: 4, n1: 100, n2: 100, n3: 100, a: 2, b: 1 },\n  roundedStar: { m: 5, n1: 2, n2: 7, n3: 7, a: 1, b: 1 },\n  square: { m: 4, n1: 100, n2: 100, n3: 100, a: 1, b: 1 },\n  star: { m: 6, n1: 90, n2: 100, n3: 100, a: 1, b: 1 },\n  triangle: { m: 3, n1: 100, n2: 200, n3: 200, a: 1, b: 1 },\n};\n\nexport { Superformula, SuperformulaTypes };\n","/* eslint-disable @typescript-eslint/no-unused-vars */\nimport * as d3 from 'd3';\nimport * as utils from './utils/utils';\nimport * as searchUtils from './utils/search-matching';\nimport { Link, Node, Hull } from './data-interfaces';\nimport Tooltip from './utils/tooltip';\nimport { DiagramStyles } from './diagram-styles';\n\nexport function load(\n  highlightedNodesChangedCallbackArg: (highlightedNodeNames: string[]) => void,\n  initialHighlightedNodeNames: string[],\n  initiallyShowOnlyHighlighted: boolean\n) {\n  highlightedNodesChangedCallback = highlightedNodesChangedCallbackArg;\n\n  prepare();\n\n  // Show a loading message\n  d3.select('#diagram').append('h3').classed('loading-info', true).html(\"Loading. This shouldn't take more than a few seconds...\");\n\n  // Load the data\n  const dataUrl: string = process.env.REACT_APP_DATA_SERVICES_URL!;\n  d3.json(dataUrl).then((uResponse: unknown) => {\n    const response = uResponse as { nodes?: Node[]; links?: Link[] };\n    nodes = response.nodes!;\n    links = response.links!;\n\n    // Remove the loading message\n    d3.select('#diagram').select('.loading-info').remove();\n\n    // Start nodes in the middle\n    for (const d of nodes) {\n      d.x = diagramWidth / 2;\n      d.y = diagramHeight / 2;\n    }\n\n    // Show the data\n    updateSimulation();\n\n    // Highlight nodes\n    if (initialHighlightedNodeNames.length > 0) {\n      for (const highlightedNodeName of initialHighlightedNodeNames) {\n        // check if node is already selected\n        const nodeIdx = utils.findIndex(nodes, (hn: Node) => utils.strEquals(utils.getNodeNameAndGroup(hn), highlightedNodeName));\n        if (nodeIdx > -1) {\n          // highlight it\n          highlightedNodes.push(nodes[nodeIdx]);\n        } else {\n          // search for node next level down\n          for (const hn of nodes) {\n            if (hn.nodes) {\n              for (const cn of hn.nodes) {\n                if (utils.strEquals(utils.getNodeNameAndGroup(cn), highlightedNodeName)) {\n                  highlightedNodes.push(cn);\n                  ungroupNodes(hn);\n                }\n              }\n            }\n          }\n        }\n      }\n      showOnlyHighlighted(initiallyShowOnlyHighlighted);\n    }\n  });\n}\n\nexport function searchForNodes(searchText: string) {\n  if (searchText === '') {\n    highlightedNodes = [];\n    hasSearchedForNodes = false;\n  } else {\n    const matchedNodes = searchUtils.SearchNodes(searchText, nodeElements);\n    highlightedNodes = matchedNodes.data();\n    hasSearchedForNodes = true;\n  }\n  showOnlyHighlighted(diagramStyles.showOnlyHighlighted && highlightedNodes.length > 0);\n}\n\nexport function showAllLabels(show: boolean) {\n  diagramStyles.showAllLabels = show;\n  highlightNodes();\n}\n\nexport function showOnlyHighlighted(show: boolean) {\n  diagramStyles.showOnlyHighlighted = show;\n  highlightNodes();\n}\n\nexport function invertBackground(invert: boolean) {\n  diagramStyles.invertedBackground = invert;\n  highlightNodes();\n}\n\nexport function setHasForceSimulation(dropForce: boolean) {\n  hasForceSimulation = dropForce;\n  updateSimulation();\n}\n\nlet highlightedNodesChangedCallback: (highlightedNodeNames: string[]) => void;\n\nlet nodes: Node[];\nlet highlightedNodes: Node[] = [];\nlet links: Link[];\nlet biggestNodePerGroup: { [key: string]: Node };\n\nlet diagramWidth: number;\nlet diagramHeight: number;\nconst nodePadding = 1.5;\nconst clusterPadding = 6;\nconst rainbow = d3.interpolateRainbow;\n\nlet nodeElements: d3.Selection<SVGGElement, Node, d3.BaseType, any>;\nlet linkElements: d3.Selection<SVGLineElement, Link, d3.BaseType, any>;\nlet linkGradients: d3.Selection<SVGLinearGradientElement, Link, d3.BaseType, any>;\nlet hullElements: d3.Selection<SVGPathElement, Hull, d3.BaseType, any>;\n\nlet svg: d3.Selection<d3.BaseType, any, HTMLElement, any>;\nlet svgDefs: d3.Selection<d3.BaseType, any, HTMLElement, any>;\n\nlet hasSearchedForNodes: boolean = false;\nlet hasForceSimulation: boolean = true;\n\n// let tooltip: Tooltip; // Not currently used, but it works if needed\n\nconst diagramStyles = new DiagramStyles();\n\n// zooming\nlet zoom: d3.ZoomBehavior<Element, unknown>;\nfunction zoomed(evt: any, ele: any) {\n  svg.select('.links').attr('transform', evt.transform);\n  svg.select('.nodes').attr('transform', evt.transform);\n  svg.select('.hulls').attr('transform', evt.transform);\n  d3.selectAll('.node-text').style('font-size', 14 * (1 / evt.transform.k) + 'px');\n}\n// Force Simulation\nlet simulation: d3.Simulation<Node, Link> = d3.forceSimulation<Node, Link>();\n\nfunction prepare() {\n  diagramWidth = Math.floor(Number(window.getComputedStyle(document.getElementById('diagram')!).width!.replace('px', ''))) - 10;\n  diagramHeight = Math.floor(Number(window.getComputedStyle(document.getElementById('diagram')!).height!.replace('px', ''))) - 10;\n\n  svg = d3\n    .select('#diagram')\n    .append('svg')\n    .classed('graph-svg-diagram', true)\n    .attr('width', diagramWidth)\n    .attr('height', diagramHeight)\n    .on('click', onBackgroundDiagramClick) as any;\n\n  svgDefs = svg.append('defs') as any;\n\n  svg\n    .append('g') // first so it's not on top\n    .classed('hulls', true);\n\n  svg.append('g').classed('links', true);\n\n  svg\n    .append('g') // last so it's on top\n    .classed('nodes', true);\n\n  // tooltip = new Tooltip(d3.select('#diagram'));\n\n  // zooming\n  zoom = d3\n    .zoom()\n    .scaleExtent([0, 40])\n    .translateExtent([\n      [0 - diagramWidth, 0 - diagramHeight],\n      [diagramWidth * 2, diagramHeight * 2],\n    ])\n    .on('zoom', zoomed);\n\n  svg.call(zoom as any).on('dblclick.zoom', null); // disable double-click zoom\n\n  // Force Simulation\n  simulation = d3\n    .forceSimulation<Node, Link>()\n    .force(\n      'link',\n      d3\n        .forceLink()\n        .id((d: Node) => utils.getNodeNameOrGroup(d))\n        .distance((slDatum: d3.SimulationLinkDatum<{}>) => {\n          const l = slDatum as Link;\n          const n1 = l.source;\n          const n2 = l.target;\n          let d: number = utils.nodeRadiusSizes.default;\n          if (utils.isNodeNotString(n1) && utils.isNodeNotString(n2)) {\n            const combinedRadiuses: number = utils.getRadius(n1) + utils.getRadius(n2);\n            d = utils.doGroupsMatch(n1, n2) ? combinedRadiuses : combinedRadiuses * 7;\n          }\n          return d;\n        })\n        .strength((slDatum: d3.SimulationLinkDatum<{}>) => {\n          const l = slDatum as Link;\n          let s: number = 0.3;\n          if (typeof l.source !== 'string' && typeof l.target !== 'string') {\n            s = utils.doGroupsMatch(l.source, l.target) ? 0.01 : 0.5;\n          }\n          return s;\n        })\n    )\n    .force(\n      'collide',\n      d3.forceCollide().radius((d: Node) => utils.getRadius(d) + 20)\n    )\n    .force('charge', d3.forceManyBody().strength(-500).distanceMin(100))\n    .force('x', d3.forceX(diagramWidth / 2))\n    .force('y', d3.forceY(diagramHeight / 2));\n}\n\nfunction tickHulls() {\n  hullElements.data(utils.convexHulls(nodes)).attr('d', utils.drawCluster);\n}\n\nfunction tickLinks() {\n  linkElements\n    .attr('x1', (d: Link) => {\n      return utils.isNodeNotString(d.source) && d.source.x ? d.source.x : 0;\n    })\n    .attr('y1', (d: Link) => {\n      return utils.isNodeNotString(d.source) && d.source.y ? d.source.y : 0;\n    })\n    .attr('x2', (d: Link) => {\n      return utils.isNodeNotString(d.target) && d.target.x ? d.target.x : 0;\n    })\n    .attr('y2', (d: Link) => {\n      return utils.isNodeNotString(d.target) && d.target.y ? d.target.y : 0;\n    });\n  linkGradients\n    .attr('x1', (d: Link) => {\n      return utils.isNodeNotString(d.source) && d.source.x ? d.source.x : 0;\n    })\n    .attr('y1', (d: Link) => {\n      return utils.isNodeNotString(d.source) && d.source.y ? d.source.y : 0;\n    })\n    .attr('x2', (d: Link) => {\n      return utils.isNodeNotString(d.target) && d.target.x ? d.target.x : 0;\n    })\n    .attr('y2', (d: Link) => {\n      return utils.isNodeNotString(d.target) && d.target.y ? d.target.y : 0;\n    });\n}\n\nfunction updateSimulation() {\n  linkElements = svg\n    .select('.links')\n    .selectAll('line')\n    .data(links, utils.getLinkGradientId as any) as any;\n  linkGradients = svgDefs.selectAll('linearGradient').data(links, utils.getLinkGradientId as any) as any;\n\n  nodeElements = svg\n    .select('.nodes')\n    .selectAll('.node')\n    .data(nodes, utils.getNodeId as any) as any;\n\n  hullElements = svg.select('.hulls').selectAll('path.hull').data(utils.convexHulls(nodes)) as any;\n\n  linkGradients.exit().remove();\n  const linkGradientsEnter = linkGradients.enter().append('linearGradient');\n  linkGradientsEnter.append('stop');\n  linkGradientsEnter.append('stop');\n  diagramStyles.applyLinkGradientDefault(linkGradientsEnter);\n  linkGradients = linkGradientsEnter.merge(linkGradients);\n\n  linkElements.exit().transition(utils.transitionLinear(100)).style('stroke-opacity', 1e-6).remove();\n  const linkEnterElements = linkElements.enter().append('line');\n  linkEnterElements\n    .on('mouseover', function (d, i) {\n      // note function (not lambda) is reqd for 'this'\n      diagramStyles.applyLinkMouseOver(d3.select(this));\n      // tooltip.Show(d3.select(this), 'a message');\n    })\n    .on('mouseout', function (d, i) {\n      diagramStyles.applyLinkMouseOut(d3.select(this));\n      // tooltip.Hide();\n    })\n    .on('click', PopulateInfoBox)\n    .style('stroke-opacity', 1e-6);\n  diagramStyles.applyLinkDefault(linkEnterElements);\n  linkElements = linkEnterElements.merge(linkElements);\n\n  nodeElements.exit().transition(utils.transitionLinear(100)).style('stroke-opacity', 1e-6).style('fill-opacity', 1e-6).remove();\n  const drager: d3.DragBehavior<any, any, any> = d3.drag();\n  drager\n    .on('drag', function (evt: any, d: Node) {\n      // function (not lambda) is reqd for 'this'\n      dragged(evt, d, d3.select(this));\n    })\n    .on('end', dragended);\n  const nodeEnterElements = nodeElements.enter().append('g').classed('node', true);\n  nodeEnterElements\n    .on('mouseover', function (d, i) {\n      // function (not lambda) is reqd for 'this'\n      diagramStyles.applyNodeMouseOver(d3.select(this));\n    })\n    .on('mouseout', function (d, i) {\n      diagramStyles.applyNodeMouseOut(d3.select(this));\n    })\n    .on('click', onNodeClick)\n    .on('dblclick', onNodeDblclick)\n    .call(drager);\n  nodeEnterElements.append('path').classed('node-shape', true);\n  nodeEnterElements.append('text').classed('node-text', true);\n  diagramStyles.applyNodeDefault(nodeEnterElements);\n  nodeElements = nodeEnterElements.merge(nodeElements);\n\n  hullElements.exit().transition(utils.transitionLinear(100)).style('fill-opacity', 1e-6).remove();\n  const hullEnterElements = hullElements.enter().append('path').classed('hull', true).style('fill-opacity', 1e-6);\n  diagramStyles.applyHullDefault(hullEnterElements);\n  hullElements = hullEnterElements.merge(hullElements);\n\n  biggestNodePerGroup = utils.getBiggestNodesPerGroup(nodes, links);\n\n  simulation.nodes(nodes).on('tick', () => {\n    const alpha = simulation.alpha();\n\n    // Force the node groups to cluster\n    for (const d of nodes) {\n      if (d.group) {\n        const biggestNode = biggestNodePerGroup[utils.strToLowerOrEmpty(d.group)];\n        if (biggestNode !== d) {\n          biggestNode.x = biggestNode.x || 0;\n          biggestNode.y = biggestNode.y || 0;\n          d.x = d.x || 0;\n          d.y = d.y || 0;\n          const x1 = d.x - biggestNode.x;\n          const y1 = d.y - biggestNode.y;\n          const l = Math.sqrt(x1 * x1 + y1 * y1); // dist between node and biggest node\n          const r = utils.getRadius(d) * 2 + utils.getRadius(biggestNode); // ideal dist between node and biggest node\n          if (l !== r) {\n            // as decay falls from 1 to 0, set a mostly consistant multiplier with small peak\n            const alphaMultiplier = -0.9 * Math.pow(alpha - 1, 2) - 0.9 * (alpha - 1) + 0.7;\n            const l1 = l - r;\n            const t = l1 / l;\n            const xr = (1 - t) * biggestNode.x + t * d.x;\n            const yr = (1 - t) * biggestNode.y + t * d.y;\n            const xd = d.x - xr;\n            const yd = d.y - yr;\n            d.x = (d.x || 0) - xd * 0.49 * alphaMultiplier;\n            d.y = (d.y || 0) - yd * 0.49 * alphaMultiplier;\n            const bxr = (1 - t) * d.x + t * biggestNode.x;\n            const byr = (1 - t) * d.y + t * biggestNode.y;\n            const bxd = biggestNode.x - bxr;\n            const byd = biggestNode.y - byr;\n            biggestNode.x -= bxd * 0.49 * alphaMultiplier;\n            biggestNode.y -= byd * 0.49 * alphaMultiplier;\n          }\n        }\n      }\n    }\n\n    tickHulls();\n\n    tickLinks();\n\n    nodeElements.attr('transform', (d: Node) => {\n      d.x = isNaN(d.x!) || d.x === 0 ? diagramWidth / 2 : d.x!;\n      d.y = isNaN(d.y!) || d.y === 0 ? diagramHeight / 2 : d.y!;\n      return 'translate(' + d.x + ',' + d.y + ')';\n    });\n  });\n  simulation.force<d3.ForceLink<Node, Link>>('link')!.links(links);\n  utils.setSimulationAlpha(simulation);\n  if (hasForceSimulation) {\n    simulation.restart();\n  } else {\n    simulation.stop();\n  }\n}\n\nlet dragSimulationRestarted = false;\n\nfunction dragged(evt: any, d: Node, nodeEles: d3.Selection<SVGGElement, Node, d3.BaseType, any>) {\n  if (hasForceSimulation) {\n    if (!dragSimulationRestarted) {\n      simulation.alphaTarget(0.02).restart();\n      dragSimulationRestarted = true;\n    }\n    d.fx = evt.x;\n    d.fy = evt.y;\n  } else {\n    d.x = evt.x;\n    d.y = evt.y;\n    nodeEles.attr('transform', 'translate(' + d.x + ',' + d.y + ')');\n    tickHulls();\n    tickLinks();\n  }\n}\n\nfunction dragended(evt: any, d: Node) {\n  if (hasForceSimulation) {\n    if (!evt.active && dragSimulationRestarted) {\n      dragSimulationRestarted = false;\n      simulation.alphaTarget(0);\n    }\n    d.fx = null;\n    d.fy = null;\n  }\n}\n\nfunction onBackgroundDiagramClick() {\n  // Clear any highlighted nodes\n  highlightedNodes = [];\n  hasSearchedForNodes = false;\n  showOnlyHighlighted(false);\n}\n\nfunction onNodeClick(evt: any, d: Node) {\n  hasSearchedForNodes = false;\n\n  // check if node is already selected\n  const highlightedNodeIdx = utils.findIndex(highlightedNodes, (hn: Node) =>\n    utils.strEquals(utils.getNodeNameAndGroup(hn), utils.getNodeNameAndGroup(d))\n  );\n  if (highlightedNodeIdx > -1) {\n    // then remove node\n    highlightedNodes.splice(highlightedNodeIdx, 1);\n  } else {\n    // highlight it\n    highlightedNodes.push(d);\n    PopulateInfoBox(evt, d);\n  }\n  showOnlyHighlighted(diagramStyles.showOnlyHighlighted && highlightedNodes.length > 0);\n  evt.stopPropagation();\n}\n\nfunction onNodeDblclick(evt: any, d: Node) {\n  if (d.nodes) {\n    // A grouped node\n    ungroupNodes(d);\n  } else if (d.name && d.group) {\n    // a single node\n    regroupNodes(d);\n  }\n\n  // Clear any highlighted nodes (animation time causes issues if it's before the grouping)\n  hasSearchedForNodes = false;\n  highlightNodes();\n\n  evt.stopPropagation();\n}\n\nfunction ungroupNodes(d: Node) {\n  // Set nodes to the coords of the parent (with random amount)\n  for (const k1 of d.nodes!) {\n    k1.x = d.x! + (1 + Math.random()) * (utils.getRadius(d) * 1.3 + utils.getRadius(k1)) * (Math.random() < 0.5 ? -1 : 1);\n    k1.y = d.y! + (1 + Math.random()) * (utils.getRadius(d) * 1.3 + utils.getRadius(k1)) * (Math.random() < 0.5 ? -1 : 1);\n  }\n  // Remove grouped node and bring child nodes up to main array\n  for (const k2 of nodes) {\n    if (k2.group && k2.nodes && utils.doGroupsMatch(k2, d)) {\n      nodes.splice(nodes.indexOf(k2), 1);\n      break;\n    }\n  }\n  Array.prototype.push.apply(nodes, d.nodes as any);\n  // Add internal links\n  if (d.internalLinks) {\n    for (const k3Link of d.internalLinks) {\n      k3Link.target = k3Link.targetChild!;\n      k3Link.source = k3Link.sourceChild!;\n    }\n    Array.prototype.push.apply(links, d.internalLinks);\n    delete d.internalLinks;\n  }\n  // Update links\n  for (const childMNode of d.nodes!) {\n    for (const lLink of links) {\n      if (\n        lLink.targetChild &&\n        (utils.strEquals(lLink.targetChild, childMNode.name) ||\n          (utils.isNodeNotString(lLink.targetChild) && utils.strEquals(lLink.targetChild.name, childMNode.name)))\n      ) {\n        lLink.target = lLink.targetChild;\n        delete lLink.targetChild;\n      }\n      if (\n        lLink.sourceChild &&\n        (utils.strEquals(lLink.sourceChild, childMNode.name) ||\n          (utils.isNodeNotString(lLink.sourceChild) && utils.strEquals(lLink.sourceChild.name, childMNode.name)))\n      ) {\n        lLink.source = lLink.sourceChild;\n        delete lLink.sourceChild;\n      }\n    }\n  }\n\n  updateSimulation();\n\n  // check if node is highlighted and remove\n  const highlightedNodeIdx = utils.findIndex(highlightedNodes, (hn: Node) =>\n    utils.strEquals(utils.getNodeNameAndGroup(hn), utils.getNodeNameAndGroup(d))\n  );\n  if (highlightedNodeIdx > -1) {\n    // then remove node\n    highlightedNodes.splice(highlightedNodeIdx, 1);\n  }\n}\n\nfunction regroupNodes(d: Node) {\n  const newNodeGroup: Node = { group: d.group, nodes: [], x: d.x, y: d.y, internalLinks: [] };\n  for (let k = 0; k < nodes.length; ++k) {\n    const kNode = nodes[k];\n    if (utils.doGroupsMatch(kNode, d)) {\n      // Group child nodes and remove from main array\n      nodes.splice(k, 1);\n      newNodeGroup.nodes!.push(kNode);\n      // Update links\n      for (const mLink of links) {\n        if (\n          (utils.strEquals(mLink.target, kNode.name) || (utils.isNodeNotString(mLink.target) && utils.strEquals(mLink.target.name, kNode.name))) &&\n          (!mLink.targetChild || (utils.isNodeNotString(mLink.targetChild) ? !utils.strEquals(mLink.targetChild.group, kNode.name) : true))\n        ) {\n          mLink.targetChild = mLink.target;\n          mLink.target = d.group || '';\n        }\n        if (\n          (utils.strEquals(mLink.source, kNode.name) || (utils.isNodeNotString(mLink.source) && utils.strEquals(mLink.source.name, kNode.name))) &&\n          (!mLink.sourceChild || (utils.isNodeNotString(mLink.sourceChild) ? !utils.strEquals(mLink.sourceChild.group, kNode.name) : true))\n        ) {\n          mLink.sourceChild = mLink.source;\n          mLink.source = d.group || '';\n        }\n      }\n      k--;\n\n      // check if node is highlighted and remove\n      const highlightedNodeIdx = utils.findIndex(highlightedNodes, (hn: Node) =>\n        utils.strEquals(utils.getNodeNameAndGroup(hn), utils.getNodeNameAndGroup(kNode))\n      );\n      if (highlightedNodeIdx > -1) {\n        // then remove node\n        highlightedNodes.splice(highlightedNodeIdx, 1);\n      }\n    }\n  }\n  // Pass through links again and get rid of internal links\n  for (let m1 = 0; m1 < links.length; m1++) {\n    const m1Link = links[m1];\n    if (utils.strEquals(m1Link.target, d.group) && utils.strEquals(m1Link.target, m1Link.source)) {\n      newNodeGroup.internalLinks!.push(m1Link);\n      links.splice(m1, 1);\n      m1--;\n    }\n  }\n  nodes.push(newNodeGroup);\n\n  updateSimulation();\n}\n\nfunction highlightNodes() {\n  highlightedNodesChangedCallback(highlightedNodes.map((n) => utils.getNodeNameAndGroup(n)));\n  if (highlightedNodes.length === 0) {\n    diagramStyles.applyNodeDefault(nodeElements);\n    diagramStyles.applyLinkDefault(linkElements);\n    diagramStyles.applyLinkGradientDefault(linkGradients);\n    diagramStyles.applyHullDefault(hullElements);\n  } else {\n    const matchedNodesData = highlightedNodes;\n    const matchedNodes = searchUtils.GetMatchedNodes(matchedNodesData, nodeElements);\n    const matchedLinks = searchUtils.GetMatchedLinks(matchedNodesData, linkElements, diagramStyles.showOnlyHighlighted);\n    const matchedLinkGradients = searchUtils.GetMatchedLinkGradients(matchedNodesData, linkGradients, diagramStyles.showOnlyHighlighted);\n    const unmatchedLinks = searchUtils.GetUnmatchedLinks(matchedNodesData, linkElements, diagramStyles.showOnlyHighlighted);\n    const unmatchedLinkGradients = searchUtils.GetUnmatchedLinkGradients(matchedNodesData, linkGradients, diagramStyles.showOnlyHighlighted);\n    const neighbourNodes = searchUtils.GetNeighbourNodes(matchedNodesData, matchedLinks.data(), nodeElements);\n    const highlightedAndNeighbourNodesData = matchedNodesData.concat(neighbourNodes.data());\n    const unmatchedNodes = searchUtils.GetUnmatchedNodes(highlightedAndNeighbourNodesData, nodeElements);\n    const matchedHulls = searchUtils.GetMatchedHulls(matchedNodesData, hullElements);\n    const unmatchedHulls = searchUtils.GetUnmatchedHulls(matchedHulls.data(), hullElements);\n\n    if (hasSearchedForNodes === true) {\n      diagramStyles.applyNodeSearch(matchedNodes);\n    } else {\n      diagramStyles.applyNodeHighlight(matchedNodes);\n    }\n\n    diagramStyles.applyNodeHighlightedNeighbour(neighbourNodes);\n    diagramStyles.applyNodeUnhighlighted(unmatchedNodes);\n    diagramStyles.applyLinkHighlight(matchedLinks);\n    diagramStyles.applyLinkUnhighlighted(unmatchedLinks);\n    diagramStyles.applyLinkGradientHighlight(matchedLinkGradients);\n    diagramStyles.applyLinkGradientUnhighlighted(unmatchedLinkGradients);\n    diagramStyles.applyHullHighlight(matchedHulls);\n    diagramStyles.applyHullUnhighlighted(unmatchedHulls);\n  }\n}\n\n// Info Box\nfunction PopulateInfoBox(evt: any, nodeOrLink: Node | Link) {\n  const divServiceDetails = d3.select('#info-box');\n  const title = utils.getNodeOrLinkTitle(nodeOrLink);\n  const notes = !utils.isLinkNotNode(nodeOrLink) ? nodeOrLink.notes || '' : '';\n  divServiceDetails.select('.title').text(title);\n  divServiceDetails.select('.notes').text(notes);\n\n  const tableElement = divServiceDetails.select('.table');\n  divServiceDetails.select('.table').selectAll('tr').remove();\n\n  const timestamp = nodeOrLink.timestamp || '';\n  divServiceDetails.select('.timestamp').text(timestamp);\n\n  if (nodeOrLink.details) {\n    // node or link\n    const tableData = Object.entries(nodeOrLink.details);\n    if (tableData.length > 0) {\n      tableElement\n        .selectAll('tr')\n        .data(tableData)\n        .enter()\n        .append('tr')\n        .selectAll('tr')\n        .data((row) => row)\n        .enter()\n        .append('td')\n        .text();\n    }\n  } else if (!utils.isLinkNotNode(nodeOrLink) && nodeOrLink.group && nodeOrLink.nodes) {\n    // group\n    tableElement\n      .selectAll('tr')\n      .data(nodeOrLink.nodes)\n      .enter()\n      .append('tr')\n      .selectAll('td')\n      .data((row: Node) => [row.name!])\n      .enter()\n      .append('td')\n      .text((d: string) => d);\n  }\n  if (evt) {\n    evt.stopPropagation();\n  }\n}\n","import * as d3 from 'd3';\nimport { schemeDark2 } from 'd3-scale-chromatic';\n\nexport const colorScale = d3.scaleOrdinal(schemeDark2.slice());\nexport const defaultNodeStrokeWidth = 1.5;\nexport const defaultLinkStrokeWidth = 1.5;\nexport const highlightColor = '#32f272';\nexport const everythingElseColor = '#31d8ea';\nexport const everythingElseOpacity = 0.2;\nexport const linkGradientColorStart = '#006eff';\nexport const linkGradientColorEnd = '#87eeff';\nexport const linkGradientColorEndInverted = '#2f5359';\n","import * as d3 from 'd3';\nimport * as utils from './utils/utils';\nimport { Superformula } from './utils/superformula';\nimport * as constants from './constants';\nimport { Link, Node, Hull, NodeStateProperties } from './data-interfaces';\nimport { BaseType } from 'd3';\n\nconst durationSecond: number = 1000;\nconst durationLong: number = 400;\nconst durationMediumLong: number = 250;\nconst durationMedium: number = 200;\nconst durationShort: number = 100;\n\nconst defaultSupaDupaPath = new Superformula().type(utils.defaultNodeSuperformulaType).size(utils.defaultNodeSuperformulaSize).segments(360);\n\nconst nodeStateDefault: NodeStateProperties = {\n  className: 'node-state-default',\n  nodeTextShiftMultiplier: 1.5,\n  shapeSuperformula: defaultSupaDupaPath,\n};\nconst nodeStateHighlight: NodeStateProperties = {\n  className: 'node-state-highlight',\n  nodeTextShiftMultiplier: 1.8,\n  shapeSuperformula: new Superformula().type(utils.defaultNodeSuperformulaType).size((d) => {\n    return 1.5 * utils.getHighlightedRadius(d);\n  }),\n};\nconst nodeStateSearch: NodeStateProperties = {\n  className: 'node-state-search',\n  nodeTextShiftMultiplier: 1.8,\n  shapeSuperformula: new Superformula()\n    .type(() => 'gear')\n    .size((d) => {\n      return 2 * utils.getHighlightedRadius(d);\n    }),\n};\nconst nodeStateHighlightNeighbour: NodeStateProperties = {\n  className: 'node-state-highlight-neighbour',\n  nodeTextShiftMultiplier: 1.8,\n  shapeSuperformula: defaultSupaDupaPath,\n};\nconst nodeStateUnhighlighted: NodeStateProperties = {\n  className: 'node-state-unhighlighted',\n  nodeTextShiftMultiplier: 1.6,\n  shapeSuperformula: defaultSupaDupaPath,\n};\n\nexport class DiagramStyles {\n  public showOnlyHighlighted: boolean = false;\n  public invertedBackground: boolean = false;\n  public showAllLabels: boolean = false;\n  private mouseOverLock: any = {};\n  private mouseOutLock: any = {};\n\n  public applyNodeDefault(nodeEles: d3.Selection<SVGGElement, Node, d3.BaseType, any>) {\n    clearStates(nodeEles);\n    nodeEles.classed(nodeStateDefault.className, true);\n    const nodeShape = nodeEles.selectAll('.node-shape');\n    const nodeText = nodeEles.selectAll('.node-text');\n    nodeShape\n      .transition(utils.transitionLinear(durationSecond))\n      .attr('d', (d: unknown) => nodeStateDefault.shapeSuperformula.getPath(d as Node))\n      .attr('stroke-width', (d: unknown) => 1)\n      .attr('stroke', (d: unknown) => constants.colorScale(utils.strToLowerOrEmpty((d as Node).group)))\n      .attr('fill', (d: unknown) => constants.colorScale(utils.strToLowerOrEmpty((d as Node).group)))\n      .style('stroke-opacity', 1)\n      .style('fill-opacity', 1);\n    nodeText\n      .style('opacity', (d: unknown) => utils.nodeTextOpacity(d as Node, this.showAllLabels))\n      .attr('text-anchor', 'right')\n      .attr('dominant-baseline', 'central')\n      .attr('transform', (d: unknown) => utils.nodeTextShiftRight(d as Node))\n      .text((d: unknown) => (d as Node).name || (d as Node).group || '');\n  }\n\n  public applyNodeSearch(nodeEles: d3.Selection<SVGGElement, Node, d3.BaseType, any>) {\n    clearStates(nodeEles);\n    nodeEles.classed(nodeStateSearch.className, true);\n    const nodeShape = nodeEles.selectAll('.node-shape');\n    const nodeText = nodeEles.selectAll('.node-text');\n    const bigSuperdupaPath = new Superformula().type(() => 'gear');\n    nodeShape\n      .transition()\n      .duration(durationMediumLong)\n      .attr('d', (d: unknown) =>\n        bigSuperdupaPath\n          .size((bd) => {\n            return 5 * utils.getHighlightedRadius(bd);\n          })\n          .getPath(d as Node)\n      )\n      .attr('stroke', (d: unknown) => constants.highlightColor)\n      .attr('fill', (d: unknown) => constants.highlightColor)\n      .style('stroke-opacity', 1)\n      .style('fill-opacity', 1)\n      .transition()\n      .duration(durationMedium)\n      .attr('d', (d: unknown) => nodeStateSearch.shapeSuperformula.getPath(d as Node));\n    nodeText\n      .transition()\n      .duration(durationLong)\n      .style('opacity', 1)\n      .attr('transform', (d: unknown) => {\n        return utils.nodeTextShiftRight(d as Node, nodeStateSearch.nodeTextShiftMultiplier);\n      });\n  }\n\n  public applyNodeHighlight(nodeEles: d3.Selection<SVGGElement, Node, d3.BaseType, any>) {\n    clearStates(nodeEles);\n    nodeEles.classed(nodeStateHighlight.className, true);\n    const nodeShape = nodeEles.selectAll('.node-shape');\n    const nodeText = nodeEles.selectAll('.node-text');\n    nodeShape\n      .transition()\n      .duration(durationMedium)\n      .attr('d', (d: unknown) => nodeStateHighlight.shapeSuperformula.getPath(d as Node))\n      .attr('stroke', () => utils.darkenIfInvertedBackground(constants.highlightColor, this.invertedBackground))\n      .attr('fill', () => utils.darkenIfInvertedBackground(constants.highlightColor, this.invertedBackground))\n      .style('stroke-opacity', 1)\n      .style('fill-opacity', 1);\n    nodeText\n      .transition()\n      .duration(durationLong)\n      .style('opacity', 1)\n      .attr('transform', (d: unknown) => {\n        return utils.nodeTextShiftRight(d as Node, nodeStateHighlight.nodeTextShiftMultiplier);\n      });\n  }\n\n  public applyNodeHighlightedNeighbour(nodeEles: d3.Selection<SVGGElement, Node, d3.BaseType, any>) {\n    clearStates(nodeEles);\n    nodeEles.classed(nodeStateHighlightNeighbour.className, true);\n    const nodeShape = nodeEles.selectAll('.node-shape');\n    const nodeText = nodeEles.selectAll('.node-text');\n    nodeShape\n      .transition()\n      .duration(durationLong)\n      .attr('d', (d: unknown) => nodeStateHighlightNeighbour.shapeSuperformula.getPath(d as Node))\n      .attr('stroke', () => utils.darkenIfInvertedBackground(constants.everythingElseColor, this.invertedBackground))\n      .attr('fill', () => utils.darkenIfInvertedBackground(constants.everythingElseColor, this.invertedBackground))\n      .style('stroke-opacity', 1)\n      .style('fill-opacity', 1);\n    nodeText.transition().duration(durationLong).style('opacity', 1);\n  }\n\n  public applyNodeUnhighlighted(nodeEles: d3.Selection<SVGGElement, Node, d3.BaseType, any>) {\n    clearStates(nodeEles);\n    nodeEles.classed(nodeStateUnhighlighted.className, true);\n    const nodeShape = nodeEles.selectAll('.node-shape');\n    const nodeText = nodeEles.selectAll('.node-text');\n    nodeShape\n      .transition()\n      .duration(durationLong)\n      .attr('d', (d: unknown) => nodeStateUnhighlighted.shapeSuperformula.getPath(d as Node))\n      .attr('stroke', () => utils.darkenIfInvertedBackground(constants.everythingElseColor, this.invertedBackground))\n      .attr('fill', () => utils.darkenIfInvertedBackground(constants.everythingElseColor, this.invertedBackground))\n      .style('stroke-opacity', this.showOnlyHighlighted ? 0 : constants.everythingElseOpacity)\n      .style('fill-opacity', this.showOnlyHighlighted ? 0 : constants.everythingElseOpacity);\n    nodeText\n      .transition()\n      .duration(durationLong)\n      .style('opacity', () => (this.showOnlyHighlighted ? 0 : this.showAllLabels ? 1 : 0))\n      .attr('transform', (d) => {\n        return utils.nodeTextShiftRight(d as Node);\n      });\n  }\n\n  public applyNodeMouseOver(nodeEles: d3.Selection<SVGGElement, Node, d3.BaseType, any>) {\n    const nodeState = getNodeStateProperties(nodeEles);\n    const nodeShape = nodeEles.selectAll('.node-shape');\n    const nodeText = nodeEles.selectAll('.node-text');\n    // A transition can already occur on a node, therefore using a custom tween\n    const mouseOverTransition = d3.select(this.mouseOverLock).transition().duration(durationShort);\n    mouseOverTransition.tween('style:stroke-width', () => {\n      const i = d3.interpolateNumber(1, 10);\n      return (t: any) => {\n        nodeShape.style('stroke-width', i(t));\n      };\n    });\n    mouseOverTransition.tween('attr:transform', () => {\n      const nodeData = nodeEles.data()[0];\n      const shiftFrom = utils.nodeTextShiftRight(nodeData, nodeState.nodeTextShiftMultiplier);\n      const shiftTo = utils.nodeTextShiftRight(nodeData, nodeState.nodeTextShiftMultiplier * 1.3);\n      const i = d3.interpolateString(shiftFrom, shiftTo);\n      return (t: any) => {\n        nodeText.attr('transform', i(t));\n      };\n    });\n    if (this.showOnlyHighlighted === false && Number(nodeText.style('opacity')) < 1) {\n      nodeText.classed('temp-show', true);\n      mouseOverTransition.tween('style:opacity', () => {\n        const i = d3.interpolateNumber(Number(nodeText.style('opacity')), 1);\n        return (t: any) => {\n          nodeText.style('opacity', i(t));\n        };\n      });\n    }\n  }\n\n  public applyNodeMouseOut(nodeEles: d3.Selection<SVGGElement, Node, d3.BaseType, any>) {\n    const nodeState = getNodeStateProperties(nodeEles);\n    const nodeShape = nodeEles.selectAll('.node-shape');\n    const nodeText = nodeEles.selectAll('.node-text');\n    // A transition can already occur on a node, therefore using a custom tween\n    const mouseOutTransition = d3.select(this.mouseOutLock).transition().duration(durationShort);\n    mouseOutTransition.tween('style:stroke-width', () => {\n      const i = d3.interpolateNumber(10, 1);\n      return (t: any) => {\n        nodeShape.style('stroke-width', i(t));\n      };\n    });\n    mouseOutTransition.tween('attr:transform', () => {\n      const nodeData = nodeEles.data()[0];\n      const shiftTo = utils.nodeTextShiftRight(nodeData, nodeState.nodeTextShiftMultiplier);\n      const shiftFrom = utils.nodeTextShiftRight(nodeData, nodeState.nodeTextShiftMultiplier * 1.3);\n      const i = d3.interpolateString(shiftFrom, shiftTo);\n      return (t: any) => {\n        nodeText.attr('transform', i(t));\n      };\n    });\n    if (nodeText.classed('temp-show')) {\n      nodeText.classed('temp-show', false);\n      if (nodeState.className !== nodeStateHighlight.className) {\n        mouseOutTransition.tween('style:opacity', () => {\n          const i = d3.interpolateNumber(1, 0);\n          return (t: any) => {\n            nodeText.style('opacity', i(t));\n          };\n        });\n      }\n    }\n  }\n\n  public applyLinkDefault(linkEles: d3.Selection<SVGLineElement, Link, d3.BaseType, any>) {\n    linkEles\n      .attr('stroke-width', constants.defaultLinkStrokeWidth)\n      .attr('stroke', (d) => {\n        return 'url(#' + utils.getLinkGradientId(d) + ')';\n      })\n      .transition(utils.transitionLinear(durationSecond))\n      .style('stroke-opacity', 1);\n  }\n\n  public applyLinkHighlight(linkEles: d3.Selection<SVGLineElement, Link, d3.BaseType, any>) {\n    linkEles.transition().duration(durationLong).style('stroke-opacity', 1);\n  }\n\n  public applyLinkMouseOver(linkEles: d3.Selection<SVGLineElement, Link, d3.BaseType, any>) {\n    linkEles.attr('stroke-width', constants.defaultLinkStrokeWidth * 3);\n  }\n\n  public applyLinkMouseOut(linkEles: d3.Selection<SVGLineElement, Link, d3.BaseType, any>) {\n    linkEles.attr('stroke-width', constants.defaultLinkStrokeWidth);\n  }\n\n  public applyLinkUnhighlighted(linkEles: d3.Selection<SVGLineElement, Link, d3.BaseType, any>) {\n    linkEles\n      .transition()\n      .duration(durationLong)\n      .style('stroke-opacity', this.showOnlyHighlighted ? 0 : constants.everythingElseOpacity);\n  }\n\n  public applyLinkGradientDefault(linkGradientEles: d3.Selection<SVGLinearGradientElement, Link, d3.BaseType, any>) {\n    const stopOne = linkGradientEles.selectAll('stop:nth-child(1)');\n    const stopTwo = linkGradientEles.selectAll('stop:nth-child(2)');\n    linkGradientEles.attr('id', utils.getLinkGradientId).attr('gradientUnits', 'userSpaceOnUse');\n    stopOne.attr('offset', '0%').attr('stop-color', constants.linkGradientColorStart);\n    stopTwo\n      .attr('offset', '100%')\n      .attr('stop-color', this.invertedBackground ? constants.linkGradientColorEndInverted : constants.linkGradientColorEnd);\n  }\n\n  public applyLinkGradientHighlight(linkGradientEles: d3.Selection<SVGLinearGradientElement, Link, d3.BaseType, any>) {\n    linkGradientEles\n      .selectAll('stop:nth-child(2)')\n      .transition()\n      .duration(durationLong)\n      .attr('stop-color', this.invertedBackground ? constants.linkGradientColorEndInverted : constants.linkGradientColorEnd);\n  }\n\n  public applyLinkGradientUnhighlighted(linkGradientEles: d3.Selection<SVGLinearGradientElement, Link, d3.BaseType, any>) {\n    linkGradientEles\n      .selectAll('stop:nth-child(2)')\n      .transition()\n      .duration(durationLong)\n      .attr('stop-color', this.invertedBackground ? constants.linkGradientColorEndInverted : constants.linkGradientColorEnd);\n  }\n\n  public applyHullDefault(hullEles: d3.Selection<SVGPathElement, Hull, BaseType, any>) {\n    hullEles\n      .attr('d', utils.drawCluster)\n      .transition()\n      .duration(durationLong)\n      .style('fill', (d: Node) => constants.colorScale(d.group || ''))\n      .style('fill-opacity', 0.3);\n  }\n\n  public applyHullHighlight(hullEles: d3.Selection<SVGPathElement, Hull, BaseType, any>) {\n    hullEles\n      .transition()\n      .duration(durationLong)\n      .style('fill', constants.highlightColor)\n      .style('fill-opacity', this.showOnlyHighlighted ? 0 : 0.2);\n  }\n\n  public applyHullUnhighlighted(hullEles: d3.Selection<SVGPathElement, Hull, BaseType, any>) {\n    hullEles\n      .transition()\n      .duration(durationLong)\n      .style('fill', constants.everythingElseColor)\n      .style('fill-opacity', this.showOnlyHighlighted ? 0 : 0.08);\n  }\n}\n\nfunction clearStates(nodeEles: d3.Selection<SVGGElement, Node, d3.BaseType, any>) {\n  nodeEles.classed(nodeStateDefault.className, false);\n  nodeEles.classed(nodeStateHighlight.className, false);\n  nodeEles.classed(nodeStateSearch.className, false);\n  nodeEles.classed(nodeStateHighlightNeighbour.className, false);\n  nodeEles.classed(nodeStateUnhighlighted.className, false);\n}\n\nfunction getNodeStateProperties(nodeEles: d3.Selection<SVGGElement, Node, d3.BaseType, any>): NodeStateProperties {\n  if (nodeEles.classed(nodeStateDefault.className)) {\n    return nodeStateDefault;\n  } else if (nodeEles.classed(nodeStateHighlight.className)) {\n    return nodeStateHighlight;\n  } else if (nodeEles.classed(nodeStateSearch.className)) {\n    return nodeStateSearch;\n  } else if (nodeEles.classed(nodeStateHighlightNeighbour.className)) {\n    return nodeStateHighlightNeighbour;\n  } else if (nodeEles.classed(nodeStateUnhighlighted.className)) {\n    return nodeStateUnhighlighted;\n  }\n  return nodeStateDefault;\n}\n","export function getUrlParameter(sParam: string): string | null {\n  const sPageURL = decodeURIComponent(window.location.search.substring(1));\n  return getKeysFromString(sPageURL, sParam);\n}\n\nexport function setUrlParameter(sParam: string, sValue: string) {\n  const sPageURL = decodeURIComponent(window.location.search.substring(1));\n\n  const sURLQueryParams = updateKeysInString(sPageURL, [{ sParam, sValue }]);\n\n  const queryFilters = '?' + sURLQueryParams;\n  window.history.pushState({}, '', queryFilters);\n}\n\nconst paramArraySeparator: string = '},{';\n\nexport function getUrlParameterAsArray(sParam: string): string[] {\n  const paramValueStr = getUrlParameter(sParam);\n  if (paramValueStr === null) {\n    return [];\n  }\n  if (paramValueStr.length > 1) {\n    const p = paramValueStr.substring(1, paramValueStr.length - 1);\n    const paramValues = p.split(paramArraySeparator).map((s) =>\n      s\n        .replace(/zzamp/g, '&')\n        .replace(/zzeq/g, '=')\n        .replace(/zzhash/g, '#')\n        .replace(/zzpercent/g, '%')\n    );\n    return paramValues;\n  }\n  return [];\n}\n\nexport function setUrlParameterAsArray(sParam: string, sValueArray: string[]) {\n  let sValue = '';\n  if (sValueArray.length > 0) {\n    sValue =\n      '{' +\n      sValueArray\n        .map((s) => s.replace(/&/g, 'zzamp').replace(/=/g, 'zzeq').replace(/#/g, 'zzhash').replace(/%/g, 'zzpercent'))\n        .join(paramArraySeparator) +\n      '}';\n  }\n  setUrlParameter(sParam, sValue);\n}\n\nfunction getKeysFromString(keysString: string, sParam: string): string | null {\n  const sURLVariables = keysString.split('&');\n  for (const sUrlVariable of sURLVariables) {\n    const sParameterName = sUrlVariable.split('=');\n\n    if (sParameterName[0] === sParam) {\n      return sParameterName[1] === undefined ? null : sParameterName[1];\n    }\n  }\n  return null;\n}\n\nfunction updateKeysInString(keysString: string, paramPairs: { sParam: string; sValue: string }[]): string {\n  const sURLVariables = keysString.length > 0 ? keysString.split('&') : [];\n  for (const paramPair of paramPairs) {\n    let parameterUpdated = false;\n    for (let i = 0; i < sURLVariables.length; i++) {\n      const sParameterName = sURLVariables[i].split('=');\n\n      if (sParameterName[0] === paramPair.sParam) {\n        sURLVariables[i] = paramPair.sParam + '=' + (paramPair.sValue || '');\n        parameterUpdated = true;\n      }\n    }\n    if (parameterUpdated === false) {\n      sURLVariables.push(paramPair.sParam + '=' + (paramPair.sValue || ''));\n    }\n  }\n  return sURLVariables.join('&');\n}\n","import './app.css';\nimport './forms.css';\nimport * as diagram from './diagram';\nimport * as React from 'react';\nimport { getUrlParameterAsArray, setUrlParameterAsArray, getUrlParameter, setUrlParameter } from './utils/url-query-param-utils';\n\nexport interface AppState {\n  inputHighlightText: string;\n  showAllLabels: boolean;\n  showOnlyHighlighted: boolean;\n  highlightedNodeNames: string[];\n  invertBackground: boolean;\n  hasForceSimulation: boolean;\n}\n\nconst urlParamLabelShowOnlyHighlighted = 'showHlOnly';\nconst urlParamLabelHighlightedNodes = 'hlNodes';\n\nexport default class App extends React.Component<{}, AppState> {\n  constructor(props: {}) {\n    super(props);\n\n    let showOnlyHighlighted = getUrlParameter(urlParamLabelShowOnlyHighlighted) === 'y';\n    const highlightedNodeNames = getUrlParameterAsArray(urlParamLabelHighlightedNodes);\n    if (showOnlyHighlighted && highlightedNodeNames.length === 0) {\n      setUrlParameter(urlParamLabelShowOnlyHighlighted, '');\n      showOnlyHighlighted = false;\n    }\n\n    this.state = {\n      inputHighlightText: '',\n      showAllLabels: false,\n      showOnlyHighlighted,\n      highlightedNodeNames,\n      invertBackground: false,\n      hasForceSimulation: true,\n    };\n\n    this.handleInputHighlightText = this.handleInputHighlightText.bind(this);\n    this.handleShowAllLabels = this.handleShowAllLabels.bind(this);\n    this.handleShowOnlyHighlighted = this.handleShowOnlyHighlighted.bind(this);\n    this.handleHighlightedNodesChanged = this.handleHighlightedNodesChanged.bind(this);\n    this.updateShowAllLabels = this.updateShowAllLabels.bind(this);\n    this.updateInputHighlightText = this.updateInputHighlightText.bind(this);\n    this.handleInvertBackground = this.handleInvertBackground.bind(this);\n    this.handleHasForceSimulation = this.handleHasForceSimulation.bind(this);\n    this.handleSearchForNodesClick = this.handleSearchForNodesClick.bind(this);\n  }\n\n  public componentDidMount() {\n    diagram.load(this.handleHighlightedNodesChanged, this.state.highlightedNodeNames, this.state.showOnlyHighlighted);\n  }\n\n  public render() {\n    return (\n      <div>\n        <div className=\"header row\">\n          <h1 className=\"col-4\">Service Registry Diagram</h1>\n          <div className=\"col-8 config-box\">\n            <label className={this.state.showOnlyHighlighted ? 'disabled' : ''}>Search</label>\n            <input\n              name=\"inputSearch\"\n              type=\"text\"\n              onChange={this.handleInputHighlightText}\n              value={this.state.inputHighlightText}\n              disabled={this.state.showOnlyHighlighted}\n            />\n            <button id=\"btnHighlight\" onClick={this.handleSearchForNodesClick} disabled={this.state.showOnlyHighlighted}>\n              Highlight\n            </button>\n            <input\n              id=\"chkboxShowAllLabels\"\n              type=\"checkbox\"\n              checked={this.state.showAllLabels}\n              onChange={this.handleShowAllLabels}\n              disabled={this.state.showOnlyHighlighted}\n            />\n            <label htmlFor=\"chkboxShowAllLabels\">Show all labels</label>\n            <input\n              id=\"chkboxShowOnlyHighlighted\"\n              type=\"checkbox\"\n              checked={this.state.showOnlyHighlighted}\n              onChange={this.handleShowOnlyHighlighted}\n              disabled={this.state.highlightedNodeNames.length === 0}\n            />\n            <label htmlFor=\"chkboxShowOnlyHighlighted\">Show only highlighted</label>\n            <input id=\"chkboxInvertBackground\" type=\"checkbox\" checked={this.state.invertBackground} onChange={this.handleInvertBackground} />\n            <label htmlFor=\"chkboxInvertBackground\">Invert Background</label>\n            <input id=\"chkboxHasForceSimulation\" type=\"checkbox\" checked={this.state.hasForceSimulation} onChange={this.handleHasForceSimulation} />\n            <label htmlFor=\"chkboxHasForceSimulation\">Force</label>\n          </div>\n        </div>\n\n        <div className=\"content\">\n          <div id=\"diagram\" className={this.state.invertBackground ? 'inverted' : ''} />\n          <div id=\"info-box\">\n            <h2 className=\"title\">Diagram</h2>\n            <div className=\"notes\" />\n            <table className=\"table\" />\n            <div className=\"timestamp\" />\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  private updateShowAllLabels(showAllLabels: boolean) {\n    this.setState({ showAllLabels });\n    diagram.showAllLabels(showAllLabels);\n  }\n\n  private updateInputHighlightText(txt: string) {\n    this.setState({ inputHighlightText: txt });\n    diagram.searchForNodes(txt);\n  }\n\n  private handleHighlightedNodesChanged(highlightedNodeNames: string[]) {\n    this.setState({ highlightedNodeNames });\n    setUrlParameterAsArray(urlParamLabelHighlightedNodes, highlightedNodeNames);\n    if (highlightedNodeNames.length === 0 && this.state.showOnlyHighlighted) {\n      this.setState({ showOnlyHighlighted: false });\n      setUrlParameter(urlParamLabelShowOnlyHighlighted, '');\n    }\n  }\n\n  private handleSearchForNodesClick() {\n    diagram.searchForNodes(this.state.inputHighlightText);\n  }\n\n  private handleInputHighlightText(event: React.ChangeEvent<HTMLInputElement>) {\n    const newVal = event.currentTarget.value;\n    this.updateInputHighlightText(newVal);\n    event.preventDefault();\n  }\n\n  private handleShowAllLabels(event: React.ChangeEvent<HTMLInputElement>) {\n    const newVal = event.currentTarget.checked;\n    this.updateShowAllLabels(newVal);\n  }\n\n  private handleShowOnlyHighlighted(event: React.ChangeEvent<HTMLInputElement>) {\n    const newVal = event.currentTarget.checked;\n    this.setState({ showOnlyHighlighted: newVal });\n    setUrlParameter(urlParamLabelShowOnlyHighlighted, newVal ? 'y' : '');\n    diagram.showOnlyHighlighted(newVal);\n    if (newVal === true && this.state.showAllLabels === true) {\n      this.updateShowAllLabels(false);\n    }\n  }\n\n  private handleInvertBackground(event: React.ChangeEvent<HTMLInputElement>) {\n    const newVal = event.currentTarget.checked;\n    this.setState({ invertBackground: newVal });\n    diagram.invertBackground(newVal);\n  }\n\n  private handleHasForceSimulation(event: React.ChangeEvent<HTMLInputElement>) {\n    const newVal = event.currentTarget.checked;\n    this.setState({ hasForceSimulation: newVal });\n    diagram.setHasForceSimulation(newVal);\n  }\n}\n","import { ReportHandler } from 'web-vitals';\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './app';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}